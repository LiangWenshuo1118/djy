# Machine Learning Force Field for Molecular Liquids: EC/EMC Binary Solvent 


#### Abstract

高精度的从头算分子动力学（MD）方法是研究凝聚相分子机制的金标准。然而，由于它们计算成本极高，很难捕捉许多与模拟长度和时间尺度缓慢收敛的关键性质。能够达到从头算模拟精度，同时又足够经济实用的机器学习（ML）方法有助于填补这一差距。在本研究中，我们介绍了一种针对EC：EMC二元溶剂（一种可充电锂离子电池中液态电解质的关键组成部分）的稳健机器学习势函数。我们识别了成功模拟这种有机分子液体混合物所需的关键要素。特别是，我们解决了由分子内和分子间相互作用的尺度分离带来的挑战，这是所有凝聚相分子系统中的一个普遍问题。


## 1. Introduction

利用机器学习（ML）方法进行分子模拟的发展，已经为模拟大尺度和长时间尺度提供了前所未有的准确性 [1-3]。机器学习方法已经成功地应用于孤立分子模型 [4-8]，在这些模型中，方向性的分子内相互作用起主导作用，以及用于无机固体和液体，在这些物质中，相互作用是均匀的 [9-22]。然而，分子凝聚相由于分子内与分子间相互作用之间存在大的尺度差异，呈现出独特的挑战 [23-28]。特别是分子混合物，由于分子间环境的不均匀性，问题更为复杂。

分子液体的许多重要性质，例如：密度、粘度和介电常数；具体而关键地依赖于分子间的力量。因此，机器学习模型必须在分子内和分子间的尺度上都获得良好的准确性。众多研究已经展示了水和水溶液 [29-33]、甲烷 [26]、离子液体 [28]，以及最近的电解质溶液 [34-36] 的机器学习势函数。模拟这些分子系统的标准方法是为分子内和分子间贡献创建单独的力场 [2, 37-39]。这种方法受到了经典力场的启发，并巧妙地解决了尺度分离的问题。然而，在反应性系统中，这种近似会失效，因为分子的身份在模拟过程中会发生变化。

在本研究中，我们有意选择针对总体相互作用进行机器学习（ML）模型的拟合，而没有显式地进行尺度分离，因此我们的势函数是完全通用的，原则上可以捕获反应性[40,41]。我们的主要目标是回答一个重要问题：在不进行明确的尺度分离的情况下，我们能否开发出一种用于分子液体混合物的准确且稳健的ML力场？特别是，这些模型能否生成长时间且稳定的分子动力学轨迹，并复现参考方法的热力学性质？正如其他研究所示，即使是复现分子系统的密度也不是一件简单的任务[42]，这值得我们进行细致的调查。我们在这里展示，对总损失函数进行良好拟合会导致在内部相对准确度上表现良好，但在相互作用方面的相对准确度表现不佳。在实践中，这使得很难拟合涉及液态热力学性质的相互作用部分。

具体而言，本文为标准LP57电解质中的二元溶剂 EC:EMC（3:7 M）开发了一个ML力场。这种配方包括由于其互补性质而组合的环状和线性碳酸酯：环状碳酸酯具有较大的偶极矩，可以有效地解离盐，而线性碳酸酯具有更高的流动性，有助于离子扩散。使用与量子计算相结合的经典动力学[43-45]，可极化力场[46-48]，反应力场[49]，短时间第一性原理动力学[47, 50]以及最近的神经网络势函数[36]，已经广泛地探究了混合液体碳酸酯电解质的溶剂结构和离子传输性质。低准确度的方法不能准确描述离子溶剂结构，而高准确度的方法由于计算代价过高而无法捕捉到慢速动力学，最终影响离子传输。参考文献[36]中的最新工作展示了一个ML势函数，该势函数以高准确度捕捉长时间尺度的离子传输，成功复现了实验扩散率。然而，在他们的模型中，分子间相互作用主要是通过基于学习到的原子电荷的库仑相互作用和纯粹几何依赖的经验性分散项来捕捉的。

近期在机器学习（ML）建模方面的努力已经发展出处理长程电静力的策略[51-57]，这在界面[32]、分子簇和气相中[58]是非常重要的。在这里，我们发现短程模型足够准确地描述我们的中性溶剂液体。这一结果与局域分子场理论（LMFT）[59]是一致的，即均匀的体系可以使用短程势进行建模。由于缺少解析基线（例如，库仑、列纳德-琼斯等），我们的机器学习建模变得更为复杂，因为力场必须准确地描述微妙的分子间相互作用以重现基础动力学。然而，我们获得的模型依然具有普遍性和多功能性。我们展示了通过迭代训练构建多样化的训练集，并仔细测试分子内和分子间的性能，我们能拟合出一个能描述EC:EMC二元溶剂液体的广泛组成的通用势。这为未来更通用、全反应性的力场铺平了道路。更重要的是，我们在这里得出的结论很可能也适用于其他分子系统。


## 2. Results

我们展示了用于EC:EMC分子溶剂的高斯近似势（GAP）[60]与平滑原子位置叠加（SOAP）描述符[61]的拟合结果。我们主要目标是在NPT系综下产生稳定的动力学行为，并准确预测参考方法的密度。对于有限尺寸的系统，受约束体积的模拟系综（NVE，NVT）可能掩盖机器学习（ML）势在描述弱的分子间相互作用方面的性能不佳。在NPT系综中，密度成为一个对分子间相互作用中微小错误高度敏感的可观察量。

在第2.1节中，我们展示了基于预生成训练集进行ML模型拟合会导致不稳定的势。在第2.2节中，我们表明迭代训练持续改进了我们的GAP模型，并导致在PBE-G06训练集上稳定的GAP-MD轨迹。我们探讨了不同的交换相关（XC）泛函（2.3），用PBE-D3数据重新训练了我们收敛的GAP模型（2.4），并将PBED3/GAP-MD的密度预测与实验结果进行了比较（2.5）。在接下来的几节（2.6-2.9）中，我们逐一介绍了多组分分子系统中拟合ML势面临的关键挑战，以及我们为解决这些问题而开发的解决方案和测试：内部/间部误差分解、刚性分子体积扫描、分子组成的可迁移性以及最终模型的优化。

量子力学计算是本文的核心，用于几个不同的背景：（i）提供构建训练集所需的能量、力和应力；（ii）使用分子复合物测试交换相关泛函；和（iii）提供从头算分子动力学（AIMD）模拟数据作为与新ML衍生结果比较的参考。


### 2.1. Pregenerated Training Sets

我们首先尝试在一个预生成的训练集上开发机器学习（ML）势能模型。我们采用经典的OPLS力场 [62] 对EC:EMC（3:7 M）进行多样性的分子构型采样，该采样覆盖了一个广泛的密度范围（0.4-1.3 $g/cm^3$）和温度范围（300-1200 K）。在所有密度下，我们都会监测均方位移（MSD），并选择使所有纳秒级OPLS轨迹保持为流体的温度。这种液体的高熵性使系统能够探索多样的分子环境。我们通过每隔数十皮秒选择不相关的配置来构建训练集，并使用PBE-G06理论水平重新计算它们的能量、力和应力张量。

我们训练了一系列不同的GAP模型，并广泛地探索了超参数空间，得到与短程截断（up to about 6 A）近似中固有力误差相当的力均方根误差（RMSEs），这一点由ref9中引入的“局部性测试”所揭示（参见SI）。然而，我们发现所有这些模型在执行NPT动力学时都不可避免地失败。图1展示了四个表现相似的GAP模型：动力学开始后不久，液体内部就会自发地出现并增长气泡，导致密度不物理地崩溃。这种不稳定性揭示了对分子间自由度（DOFs）的描述不佳。

有趣的是，所有模型在NVT和NVE集合下都产生稳定的动力学，图1中有一个示例。分子在模拟过程中保持完整，这表明所有模型都能相当好地捕捉分子内自由度。由于能量均分，大部分热能储存在更多的分子内模式中，这解释了为什么势能和动能在分子间模式描述不佳的情况下仍然稳定。由于分子间模式较软，它们不太可能在1 fs的时间步长下导致积分问题，因此在固定体积集合下，动力学可能看似稳定。在NPT集合下观察到的密度对分子间相互作用不佳的描述更为敏感${ }^{2}$。

${ }^{2}$ In the thermodynamic limit, all ensembles are equivalent. Therefore, bubble instability will eventually form in the NVE/NVT simulations as well, but might require significantly larger system sizes. 

![](https://cdn.mathpix.com/cropped/2023_08_31_aa90bf73c6efbe67250eg-03.jpg?height=848&width=808&top_left_y=197&top_left_x=200)

Figure 1: Bubble instabilities. Panels A and B show the potential energy and temperature of GAP-MD simulations in the NVE and NPT ensembles, respectively. Panel $\mathrm{C}$ shows the evolution of density in the NPT ensemble for four different GAP models, which reveals trajectories are unstable and form bubbles (green shaded volume). The problem persists for all GAP models trained on OPLS-generated training sets, independent of the model hyper-parameter choice.

### 2.2 Iterative Training

迭代训练解决了机器学习训练中固有的自洽性问题：优秀的势函数（potentials）不仅需要一个能代表DFT（密度泛函理论）势能面（PES）概率分布的训练集，还需要在更远距离（即从未通过在真实PES上的模拟遭遇过的配置）有合理的准确性，否则其用作采样器时将无法生成适当的分布。

我们采用了一种迭代训练协议，该协议能同时改善我们的势函数和由势函数生成的训练数据集的多样性。训练是基于PBE-G06数据进行的，所有GAP模型都采用双重SOAP（DS）或双重Turbo SOAP（DTS）描述符[63]（详见方法部分）。在NPT动力学中观察到的非物理密度波动被用作收集新配置并扩展训练集的代理标准。作为协议的一部分，我们针对混合分子液体中由分子内和分子间相互作用的不平衡性引发的关键挑战进行了解决。具体而言，我们在训练数据中添加了多种分子组成、孤立分子，以及刚性分子体积扫描。此外，我们分析了分子内和分子间错误，并使用这些指标来优化SOAP描述符。我们使用48分子NPT GAP-MD来测试势函数，并在不同温度和分子组成下监测密度波动。我们还通过在相同温度和组成下，但从不同配置出发，运行独立的轨迹来检查可重复性。基于OPLS动力学和实验结果，我们预计密度应随组成单调递减：从纯EC最高到纯EMC最低。

图2显示了我们的GAP模型在多代迭代训练中的系统性改进。经过几次迭代，在Gen5/DS上，目标分子组成EC:EMC（3:7 M）的密度在100 ps的轨迹中相对稳定，即使在高达500 K的温度下也是如此。这个模型明显优于那些基于预生成的OPLS数据进行训练的模型，并且不会形成气泡。有趣的是，该势函数不能转移到与3:7 M目标不同的分子组成上。同时，在100 ps的时间尺度上，该模型在可重复性测试方面表现不佳。这些问题可能是相互关联的：对于不同的局部环境，其能量预测的质量基于分子组成而有很大的不同。由于这些局部环境在长时间尺度上持续存在，因此从不同初始条件开始的模拟受到不同系统误差的主导，从而产生不同的密度。

在完成Gen5/DS之后，我们通过添加从纯EC到纯EMC的各种分子组成来扩展训练集。到Gen10/DS时，我们发现所有组成的动力学都已稳定。然而，关于组成的密度排序仍然不准确。特别是，纯EC的平衡密度与其他组成相比过低。在目标组成上，我们发现该模型在可重复性测试上表现得更好，但所有温度下的密度都高于Gen16/DTS得到的最终值。

从Gen11/DS开始，我们将孤立分子和刚性分子体积扫描加入到训练集中（详细内容见下文），这显著改善了对分子间相互作用的描述。结果显示，Gen13/DS生成的模型具有更物理性的动力学，解决了密度排序问题，并且将密度拉近了与最终收敛值的距离。然而，在较高温度下（500 K），由于对分子间相互作用的描述仍然不够准确，不物理的密度波动依然存在。我们优化了模型的超参数，并用Turbo SOAP替换了原有的SOAP描述符，该描述符使用了更优的径向基础[63]。经过这些改变，到Gen16/DTS时，我们实现了在所有组成和温度下的NPT动力学收敛，证明了EC:EMC液体溶剂的GAP模型具有很好的鲁棒性。


![](https://cdn.mathpix.com/cropped/2023_08_31_aa90bf73c6efbe67250eg-04.jpg?height=984&width=1678&top_left_y=192&top_left_x=196)

Figure 2: Iterative training and GAP-MD density. Successive iterations (left to right) show increasingly stable 48-molecule GAP-MD trajectories for the reference molecular composition at different temperatures (panel A) and for a range of molecular compositions at $400 \mathrm{~K}$ (panel B). The curved arrows on top indicate the most important additions between these key generations of the model. Panel $\mathrm{C}$ shows the distribution of densities extracted from the last $80 \mathrm{ps}$ of each GAP-MD trajectory across different models. This shows reproducibility (top) at identical thermodynamic conditions but different starting configurations, temperature dependence (middle) and dependence on molecular compositions (bottom).

### 2.3. Solvent Dimer Interactions

迭代训练使用PBE-G06构建最终的训练集。在本节中，我们通过比较不同溶剂二聚体的相互作用能(如图3所示)，探索了其他交换关联泛函和色散校正方案相对于黄金标准PNOLCCSD(T)-F12/AVTZ-F12耦合簇理论的准确性。耦合簇计算表明，(EC)2 具有最高的结合能（-0.45 eV），(EMC)2 具有最低的结合能（-0.23 eV），而混合的(EC)1(EMC)1介于两者之间（-0.31 eV）。在这里测试的所有XC泛函都遵循与耦合簇参考相同的趋势。在不进行色散修正的情况下，所有XC泛函都低估了相互作用能量，这与GGA和混合DFT泛函需要此类修正来描述我们系统中存在的弱色散作用的共识一致。包含色散修正后，我们观察到(EC)2和(EC)1(EMC)1有相当大的改进。在(EMC)2的情况下，由于EMC分子的非极性特性，相互作用能量被一致地高估。

在选择用于模拟我们系统的XC泛函时，我们也考虑到了计算成本。在有机电解质的情况下，由于其内在的结构复杂性，只有少数几个从头模拟（AIMD）存在[64]。通常，这样的模拟使用GGA泛函进行，以减轻由于大量原子数量所带来的有限尺寸效应。从我们的二聚体扫描中，我们观察到，在图3中选择的泛函中，PBE-D3（GGA）和PBE0-D3（混合GGA）在描述溶剂成分的相互作用能量方面具有类似的准确性。因此，我们选择了成本较低的PBE-D3来验证本研究中开发的训练策略。

![](https://cdn.mathpix.com/cropped/2023_08_31_aa90bf73c6efbe67250eg-04.jpg?height=642&width=836&top_left_y=1566&top_left_x=1041)

Figure 3: Ab initio dimer interaction energies. Panel A shows interaction energy curves for $EC_2$, $EMC_2$ and $EC_1 EMC_1$ dimers at the PNO-LCCSD(T)F12 level of theory. Panels B-D show interaction energies for $EC_2, EMC_2$ and $EC_1 EMC_1$ dimers, respectively, computed with four different XC functionals, with and without dispersion correction, as well as the reference PNO-LCCSD(T)-F12 result.


### 2.4. Comparison to Ab Initio MD

我们用两种最佳的GAP模型与目标组成EC:EMC(3:7 M)在500 K下的第一性原理动力学模拟(AIMD)结果进行了测试,结果表明两种势都表现良好。具体而言,双Turbo SOAP (Gen16/DTS)给出了与DFT密度和径向分布函数最佳的一致性。所有AIMD模拟都是在PBE-D3水平上进行的。原始的PBE-G06训练集被用PBE-D3重新计算,Gen16/DS和Gen16/DTS模型都在新的数据集上重新训练。值得注意的是,我们发现两种不同色散方案(G06和D3)之间模型转移性良好,不需要额外的迭代训练。

通常,用小盒子体系收敛NPT-AIMD模拟仍然是一个挑战,比如需要非常密集的k空间采样和大的平面波截断能[65]。我们通过运行多个NVT模拟来绕过这个问题,其中我们监测压力期望值并进行插值以找到平衡密度。每个轨迹包含48个分子,持续20 ps。每个AIMD模拟花费0.5 M核时,而等价的GAP-MD模拟花费250核时,对应速度提升2000倍。

图4比较了三种方法的一些径向分布函数(RDF)(详见补充材料)。我们计算部分RDF,将其分为聚合物内和聚合物间贡献,对每个原子元素对(a b):

$$
\begin{aligned}
g_{\text {intra }}^{a b}(r) & =\frac{V}{4 \pi N r^{2}}\left\langle\sum_{i}^{N_{a}} \sum_{j}^{N_{b}} h_{i j} \delta\left(r-r_{i j}\right)\right\rangle \\
g_{\text {inter }}^{a b}(r) & =\frac{V}{4 \pi N r^{2}}\left\langle\sum_{i}^{N_{a}} \sum_{j}^{N_{b}}\left(1-h_{i j}\right) \delta\left(r-r_{i j}\right)\right\rangle \\
h_{i j} & = \begin{cases}1 & i, j \text { same molecule } \\
0 & i, j \text { different molecules }\end{cases}
\end{aligned}
$$

因此，总的RDF简单地为：

$$
g(r)=\sum_{a, b} g_{\text {intra }}^{a b}(r)+g_{\text {inter }}^{a b}(r)
$$

两种GAP模型与AIMD结果良好一致。在短距离范围内,聚合物内RDF曲线与AIMD无法区分,表示分子内几何结构被很好地重现。我们单独报告较长范围的聚合物内RDF(4到8埃区间)以证明即使对于RDF这种细微的结构,一致性也非常好。该信号的这部分描述了比EC更长的EMC分子,并对EMC构象的种群敏感。即使在大于截断半径$R_{\text{cut}}=6$埃的距离上,两种模型也很好地重现了曲线,表示获得了正确的EMC异构体种群。最后,聚合物间RDF也有很好的一致性,表明两种模型正确捕获了更微妙的聚合物间相互作用。

图4还显示了在三种不同密度下用NVT动力学获得的压强分布。我们通过平均5 ps轨迹窗口计算压强的期望值及其标准误差。我们使用幂函数$P(\rho)=a\rho^n + b$进行插值,其灵感来自Murnaghan-Tait状态方程(EOS),并标出压强为零时的平衡密度。Gen16/DTS在标准条件下的密度与AIMD密度良好一致。此外,所有密度下的压强分布与AIMD结果重叠(图4D),拟合的EOS也是如此。Gen16/DS模型预测的标准状态密度更高,但在容差范围内与AIMD一致。与AIMD的整体EOS一致性较差,因此我们认为Gen16/DTS是更好的模型。

![](https://cdn.mathpix.com/cropped/2023_08_31_aa90bf73c6efbe67250eg-05.jpg?height=1120&width=828&top_left_y=196&top_left_x=1044)

Figure 4: Comparison of GAP-MD to AIMD on the EC:EMC (3:7 M) composition. Panels A, B show selected intra-molecular RDFs (C-O and $\mathrm{H}-\mathrm{C}$ ) at $\rho=0.95 \mathrm{~g} / \mathrm{cm}^{3}$. Panel B zooms in on the subtle structure at longer-range. Panel $\mathrm{C}$ shows the $\mathrm{C}-\mathrm{O}$ intermolecular RDFs at all three densities. Panels D shows the pressure distributions obtained in the NVT ensemble, for the target molecular composition, at different three fixed densities. Panel $\mathrm{E}$ shows the equilibrium pressure as function of density for the three models, as well as the Murnaghan-Tait inspired EoS. The zeropressure intercept is marked with vertical dashed lines, whereas the equilibrium pressures obtained from NPT GAP-MD simulations are marked with crosses.


### 2.5. Comparison to Experiment

图5显示了使用配合PBE-D3泛函数获得的Gen16/DTS 1000原子GAP-MD模拟。所有四种组成的轨迹在1纳秒内都是稳定的。密度分布是高斯的,我们没有观察到非物理的密度波动。

鉴于本工作的收敛结果,机器学习势的密度预测代表了对应DFT的结果。因此,我们可以说,对于EMC含量高的模拟,PBE-D3密度与实验结果良好一致,而EC含量高的组成的密度被低估了。密度关于温度的斜率决定了热膨胀系数,对所有组成而言,PBE-D3都很好地逼近了这个斜率。

![](https://cdn.mathpix.com/cropped/2023_08_31_aa90bf73c6efbe67250eg-06.jpg?height=832&width=830&top_left_y=188&top_left_x=1045)

Figure 5: Comparison of PBE-D3 to experiment. Panels A and B show 1000-atom, 1 nanosecond GAPMD obtained with Gen16/DTS for all molecular composition at $300 \mathrm{~K}$ and $350 \mathrm{~K}$, respectively. Panel $\mathrm{C}$ shows experimental density values at different compositions and temperatures from ref [66] (diamonds) and this work (crosses). Ref [66] gives concentrations by weight, converted here to molar compositions. The curves are third degree polynomials fitted to the data and dotted vertical lines indicate the exact molecular compositions of the GAP-MD simulations (see Methods section). Panel D compares the GAP-MD densities (circles) to the interpolated experimental densities from panel $\mathrm{C}$ (diamonds and crosses) and the additional data for pure EC (squares) from ref [67].


### 2.6. Intra-/Inter- Decomposition

分子内力和应力张量比分子间作用大一个数量级，并且它们主导了ML损失函数。与此同时，EC:EMC液体的热力学和动力学观测值，如密度和自扩散率，主要由较弱的分子间作用决定。因此，测试我们的GAP模型在分子内和分子间组分上的性能是有指导意义的。在一种方法中，我们从液体配置开始，其中每个原子坐标可以表示为：

\begin{equation}
\boldsymbol{r}_i=\boldsymbol{\tau}_j+\Theta_j \boldsymbol{\xi}_i
\end{equation}

其中，$\boldsymbol{\tau}_j$ 和 $\Theta_j$ 是分子$j$的平移和旋转，而 $\boldsymbol{\xi}_{i}$ 代表原子$i$在分子$j$参考系中的内部坐标。我们将模拟盒子拆解为单个分子。

对于每一个分子，我们保持每个分子的原始几何形态 $\boldsymbol{\xi}_{i}$，并重新计算其所有的属性，得到整个配置的纯分子内部贡献：

\begin{equation}
\begin{aligned}
& E^{\text {intra }}\left(\boldsymbol{\tau}_j+\Theta_j \boldsymbol{\xi}_i\right)=\sum_j E_j^{\text {intra }}\left(\boldsymbol{\xi}_i\right) \\
& F^{\text {intra }}\left(\boldsymbol{\tau}_j+\Theta_j \boldsymbol{\xi}_i\right)=\bigcup_j \Theta_j^T F_j^{\text {intra }}\left(\boldsymbol{\xi}_i\right)
\end{aligned}
\end{equation}

其中，分子内能对 $\boldsymbol{\tau}_{j}$ 和 $\Theta_{j}$ 保持不变，而分子内力和应力张量对 $\boldsymbol{\tau}_{j}$ 保持不变，并与 $\Theta_{j}$ 等效。我们计算分子间贡献为差值：

\begin{equation}
\begin{aligned}
& E^{\text {inter }}\left(\boldsymbol{\tau}_j+\Theta_j \boldsymbol{\xi}_i\right)= \\
& \quad E^{\text {total }}\left(\boldsymbol{\tau}_j+\Theta_j \boldsymbol{\xi}_i\right)-\sum_j E_j^{\text {intra }}\left(\boldsymbol{\xi}_i\right)
\end{aligned}
\end{equation}

这适用于GAP和DFT值。

我们用于分离分子内/分子间误差的另一种方法是基于分子DOFs。我们将原子力分解为平移、旋转和振动部分[68]，使用：

$$
\begin{aligned}
& f_{i}^{\text {trans }}=\frac{m_{i}}{M_{j}} \sum_{k \in j} f_{k} \\
& f_{i}^{\text {rot }}=m_{i} r_{i} \times\left(I_{j}^{\alpha \beta}\right)^{-1} \sum_{k \in j} f_{k} \times r_{k} \\
& f_{i}^{\text {vib }}=f_{i}-f_{i}^{\text {trans }}-f_{i}^{\text {rot }}
\end{aligned}
$$

其中

$$
\begin{aligned}
M_{j} & =\sum_{i \in j} m_{i} \\
I_{j}^{\alpha \beta} & =\sum_{i \in j} m_{i}\left(\left\|r_{i}\right\|^{2} \delta^{\alpha \beta}-r_{i}^{\alpha} r_{i}^{\beta}\right)
\end{aligned}
$$

是每个分子$j$的质量和转动惯量张量，$r_{i}$是相对于分子质心的原子位置。这种分解的优点是它可以原地完成，无需对孤立的分子进行额外的计算，但它只适用于力而不适用于能量和应力张量。

我们使用下面定义的均方根误差(RMSE)和相对均方根误差(RRMSE)来量化误差：

$$
\begin{aligned}
& \text { RMSE }=\sqrt{\frac{1}{N} \sum_{i}\left(f_{i}^{\mathrm{DFT}}-f_{i}^{\mathrm{GAP}}\right)^{2}} \\
& \mathrm{RRMSE}=\sqrt{\frac{\sum_{i}\left(f_{i}^{\mathrm{DFT}}-f_{i}^{\mathrm{GAP}}\right)^{2}}{\sum_{i}\left(f_{i}^{\mathrm{DFT}}-\overline{f^{\mathrm{DFT}}}\right)^{2}}}
\end{aligned}
$$

在图6中，我们展示了GAP-DFT力的相关图，既包括总体力分量也包括内部分量和分子间分量。我们使用了一个测试集，其中包含40个从GAPMD模拟中获得的液态结构，这些模拟存在非物理性的密度波动。Gen10/DS和Gen11/DS模型都得到了不错的总体力的RMSE，这约为最大力值 $(\sim 6 eV/\text{Å})$ 的3%。


Gen10/DS在其训练集中不包括孤立的分子，因此在内部力和间隔力组件上的表现都很差。这是模型有限的外推能力的结果，该模型只在液态配置上进行了训练，不能准确预测孤立分子的属性（内部组件）。间隔上的大误差简单地从内部误差传播过来，并不代表模型的真实准确性。这一结论得到了基于自由度的力的分解的支持，其中两种模型在所有力组件上的表现都相当好。

在Gen11/DS中，我们在训练集中包括了孤立的分子，并得到了内部/间隔误差的有意义的分解。这个模型，对内部和间隔力产生了明显更好的RMSE，尽管总的RMSE与Gen10/DS中的大致相同。在这种情况下，这两个RMSE组件可以预测模型在两个单独的交互尺度上的准确性。尽管这两种贡献的绝对RMSE相似，但在相对条款(RRMSE)中，间隔分子误差显著大于内部：1.26 vs 0.09，因为间隔力$(\sim 0.5 eV/A)$比内部力$(\sim 5 eV/A)$小一个数量级。降低间隔-RMSE（或在DOF分解中的平移和旋转）是这项工作的主要挑战，也是我们希望获得稳定的动力学和依赖于间隔分子力的属性的所有分子凝结相系统中的一般挑战。

![](https://cdn.mathpix.com/cropped/2023_08_31_aa90bf73c6efbe67250eg-07.jpg?height=794&width=1692&top_left_y=190&top_left_x=183)

Figure 6: Separation of intra-/inter- errors. Panel A illustrates both decomposition procedures: intermolecular contributions are the difference between intra- and total- components. Total forces are also the sum of translational, rotational and vibrational components. Panels B and C show the DFT-GAP force correlation plots separated into intra-/inter- contributions for two different GAP models: Gen10/DS and Gen11/DS (additional data in the SI).


### 2.7. Rigid-molecule Volume Scans

图7B所示的刚性分子体积扫描被引入作为一项附加测试，以量化在势能面（PES）上特定路径上的纯粹的分子间相互作用：

\begin{equation}
\boldsymbol{r}_i(s)=s \boldsymbol{\tau}_j+\Theta_j \boldsymbol{\xi}_i
\end{equation}

其中，分子的内部自由度和分子旋转被冻结，通过调整所有分子的质心，体积由因子 \( s \) 在其初始值周围进行缩放。扫描的起点是来自GAP-MD轨迹的液体构型。

所得到的能量曲线是纯粹的分子间性质：

\begin{equation}
E^{\text {total }}(s)=E^{\text {inter }}(s)+\left.E^{\text {intra }}\right|_{\xi=\text { const }}
\end{equation}

这些曲线展现出一个陡峭的排斥部分，当体积被压缩超过其平衡值 (s<1)，以及在相反方向 (s>1)有一个吸引部分。在长距离$(s \gg 1)$下，我们系统中分子间能量的主导贡献是静电作用。具体来说，由于所有分子都是电中性的，主要贡献是作为$1 / r^{3}$衰减的偶极子-偶极子相互作用。剩余的色散-感应相互作用具有$1 / r^{6}$的依赖性，并在较短的范围内消失。在二体近似下，沿着这条曲线的能量可以理解为许多不同分子二聚体曲线在多个方向上的平均值。实际上，我们发现这些测试与GAP-MD模拟中模型的稳定性有很好的相关性。


图 7C 展示了在三种不同的 GAP 模型中随体积扫描变化的能量曲线：Gen10/DS 仅基于液体构型进行训练，Gen11/DS 在液体和独立分子构型上进行训练，而 Gen12/DS 的训练集还包括了一些体积扫描。这些预测与 DFT 结果进行了比较。Gen10/DS 在平衡体积$(s \approx 1)$附近能够很好地复现从头算的参考数据，但在排斥和吸引区域都有所高估。这种过度“结合”减小了 Gen10/DS 与早期模型相比的密度波动，但同时也导致了密度高估（见图 2C）和在 MD 模拟中流动性降低。我们发现，在 Gen11/DS 中加入独立分子可以改善能量曲线在零密度区域的预测，这里的相互能量消失，总能量变为纯粹的内部能量。

将一部分体积扫描的构型重新纳入训练集（Gen12/DS）可以改善整体的能量曲线预测，包括在未见测试曲线上（见图 7C）。体积扫描构型在配置空间中插值液体环境和独立分子，这一点可以从核主成分分析（K-PCA）图（图 7A）中看出。这些特殊构型有助于改进沿着分子间模式浅曲率的势能面（PES）采样，这些模式在 MD 过程中可能会被采样不足。一方面，在 \(s<1\) 区域能量的更好估计意味着原子的排斥核心得到了更好的捕捉，这有助于在 MD 过程中避免非物理性的近距离接触。另一方面，吸引区域能量预测的改进意味着 Gen12/DS 准确地捕捉了体积内的中距离分子间相互作用，尽管它是一个有限范围模型。有了这个模型，预测的 NPT 密度与所有分子组成的收敛值更为一致（见图 2C）。


![](https://cdn.mathpix.com/cropped/2023_08_31_aa90bf73c6efbe67250eg-08.jpg?height=632&width=814&top_left_y=1028&top_left_x=196)

Figure 7: Rigid-molecule volume scan. Panel A shows the K-PCA of the Gen16 training data set labeled by type of molecular configuration: liquid configurations (pink), volume scans (yellow), and isolated molecules (light green). Panel B illustrates the volume scan technique. Panel $\mathrm{C}$ shows a selected energyvolume curve for EC:EMC (3:7 M) obtained with DFT and three different GAP generations. The volume scan reported here was not part of the training set (additional data in the SI).

### 2.8. Molecular Compositions

The inter-molecular interactions are difficult to capture because they are weaker, but also because the relevant geometries are more diverse than for intra-molecular interactions. With $n$ the number of molecules and $N$ the average number of atoms per molecule, there are $3 n(N-2)$ intra-molecular DOFs and $6 n$ intermolecular ones. In the EC:EMC (3:7 M) system this equates to $34 n$ intra- and just $6 n$ inter- DOFs. However, with just two molecule types in the liquid, most intra- environments are identical to each other, whereas inter- environments vary significantly owing to the continuous reorientation of the molecules in the liquid state and the additional randomness due to mixing. As a result, capturing the richness of inter-molecular environment is a significantly harder task for the ML models.

Models trained only on the target molecular composition $\mathcal{C}_{t}=3: 7 \mathrm{M}$ (up to Gen5/DS) are not transferable to other compositions $\mathcal{C} \neq \mathcal{C}_{t}$. This manifests as poor stability of GAP-MD simulations at $\mathcal{C} \neq \mathcal{C}_{t}$ (figure $2 \mathrm{~B}$ ), which are plagued by the formation of bubbles, and it is also apparent in volume scan tests. The poor transferability can be understood by examining the K-PCA plot of a single atom type (SI for details) shown in figure 8A. Local atomic environments originating from different liquid compositions $\mathcal{C}$ occupy distinct regions in configuration space, meaning models trained only on $\mathcal{C}_{t}$ operate in an extrapolative regime when tested on other compositions.
![](https://cdn.mathpix.com/cropped/2023_08_31_aa90bf73c6efbe67250eg-09.jpg?height=764&width=836&top_left_y=904&top_left_x=178)

Figure 8: Molecular compositions. Panel A shows the K-PCA of $\mathrm{C} 1 / \mathrm{EC}$ carbon atoms (atom labels in SI) in the Gen16 training set, colored based on global molecular composition $\mathcal{C}$. Panel B shows $f\left(c \mid \mathcal{C}_{t}\right)-\mathrm{a}$ typical distribution of local environments at the target composition $\mathcal{C}_{t}$, computed from a GAP-MD trajectory. Panels $\mathrm{C}$ and $\mathrm{D}$ show a series of volume scans at two different compositions, obtained with DFT and three different GAP models. Gen5+IM/DS and Gen6+IM/DS were fitted on training sets Gen5 and Gen6 augmented with OPLS isolated molecules. Insets illustrate the corresponding molecular compositions: EC (orange) and EMC (cyan).

Figure 8 shows a collection of volume scans for two molecular compositions: $3: 7 \mathrm{M}$ and 7:3 M, obtained with different GAP models. Gen5/DS which was trained only on the target composition, correctly reproduces the energy of the 3:7 M composition at the equilibrium density but grossly under/overestimates the energy at 7:3 M, by hundreds of $\mathrm{meV} /$ atom. Adding isolated molecules to the training set improves the 7:3 M prediction and the new model, Gen5+IM/DS, correctly reproduces the total energy in the limit $s \rightarrow \infty$, where only intra-molecular energy terms survive.
The error in the inter-molecular energy of the $7: 3 \mathrm{M}$ liquid state $(s \approx 1)$ is reduced by about 50 $\mathrm{meV} /$ atom, however adding isolated molecules is not sufficient to fix this problem. In Gen6+IM/DS we further extend the training set by adding configurations across the full range of molecular compositions. As shown in figure $8 \mathrm{D}$, this new model performs significantly better and volume scan energy predictions at $s \approx 1$ are within a few $\mathrm{meV} /$ atom of the DFT values. Importantly, GAP-MD trajectories obtained with models above Gen6/DS are stable at all compositions (figure 2).

Augmenting the training sets with the full range of compositions, significantly improves the representation of all local molecular environments $c$ and these models perform better on $\mathcal{C}_{t}$ as well. At a fixed $\mathcal{C}$, the typical GAP-MD trajectory explores a wide range of environments $c$ defined as the number of molecules of each type within a cutoff radius $R$ of a center molecule:

$$
c=\left\{n_{\mathrm{EC}}^{R}, n_{\mathrm{EMC}}^{R}\right\}
$$

The probability distribution of such environments depends on the global composition $f(c \mid \mathcal{C})$ and some environments are more likely than others. Figure $8 \mathrm{~B}$ shows an example distribution from GAP-MD at $\mathcal{C}_{t}$. While the most prevalent environment is $c \equiv \mathcal{C}_{t}$, some atypical environments like $c=\{3,0\}$ still occur with non-zero probability. In models up to Gen5/DS (trained only on $\mathcal{C}_{t}$ ) such low-probability environments are poorly represented in the training set and therefore yield large errors. Extending the training sets to the full range of compositions $\mathcal{C}$ improves the coverage of all local molecular environments $c$ and reduces the overall errors, including at the target composition $\mathcal{C}_{t}$. This is reflected in more stable and reproducible GAP-MD trajectories at $\mathcal{C}_{t}$.

### 2.9. Model Optimization

所有高于 Gen11/DS 的 GAP 模型都是在单独分子、体积扫描和多种组成上进行训练的。这些特殊配置显著提高了训练集的多功能性以及分子间相互作用的描述。密度崩溃问题得到了很大程度的解决，然而直到 Gen15/DS 的模型在 GAP-MD 中仍然表现出可逆的、但非物理的密度波动，特别是在较高的温度下（见图 9A 和 2A）。迭代训练并不能改善这些问题，这暗示还需要进一步优化模型。

通过用 DFT（图 9B）重新评估这种密度波动的选定点，我们发现 Gen15/DS 准确地再现了内部能量，然而分子间的能量被系统性地低估了大约 4-9 meV/原子。令人惊讶的是，密度下降 40% 只改变了 DFT 分子间能量约 10 meV/原子，而 Gen15/DS 模型低估了这一能量障碍约 5 meV/原子。这意味着需要非常精确的分子间能量（1 meV/原子的量级）来保持 NPT 模拟的稳定性。我们发现，通过调整模型的超参数，我们可以改善这些错误。具体来说，增加 $N_{\text {sparse }}$ 提高了模型的灵活性，这是描述复杂分子间环境所必需的。更大的 $\sigma_{\text {atom }}$ 使得原子密度更加平滑，径向函数更加广泛，这降低了分辨率但提高了模型的规整性（详见补充信息）。

我们发现，使用 Turbo SOAP [63] 而不是原始的 SOAP [61]，显著提高了分子间力和能量的错误，以及模型的平滑性。图 9C 将 Gen15/DS 和 Gen15/DTS（双重 Turbo SOAP）在一个由 40 个液态配置组成的测试集上进行了比较。Gen15/DTS 的分子间能量 RMSE 大约为 1 meV/原子，分子间力的 RMSE 小了 40%。此外，Turbo SOAP 模型产生更平滑的体积扫描曲线，如图 9D 所示的分子质心力量表明。这一改进主要归因于 poly3gauss 径向基础的质量，其他大多数参数保持不变（更多详细信息见补充信息）。

对于 SOAP 和 Turbo SOAP 的这些优化，都导致了 Gen16 性能的提升。使用 Gen16/DS 和 Gen16/DTS 获得的 GAP-MD 动力学在所有组成和温度高达 500 K 的条件下都是稳定的（见图 2 和补充信息）。


![](https://cdn.mathpix.com/cropped/2023_08_31_aa90bf73c6efbe67250eg-10.jpg?height=696&width=824&top_left_y=186&top_left_x=200)

Figure 9: GAP model optimization. Panel A shows a 12-molecule Gen15/DS-MD simulation at $500 \mathrm{~K}$ and target composition. Panel B zooms in on an unphysical density fluctuation. Both intra- and inter- energies were recomputed with DFT and Gen15/DTS - a double turbo soap model. Panel C shows the DFT-GAP inter-molecular energy and force correlation plots for both Gen15/DS and Gen15/DTS on a 40-config test set (includes 15 configs from panel B). Panel D shows the inter-molecular center of mass force experienced by one molecule in a volume scan at the target composition.

## 3. Conclusions

在这项工作中，我们展示了一种针对EC：EMC二元溶剂的稳健机器学习（ML）训练协议，并识别了开发收敛机器学习模型的关键挑战。我们使用大量的从头算分子动力学（MD）结果验证了我们最佳的模型，并将密度预测与实验值进行了比较。以下是我们的主要发现。

基于预生成的、静态的数据集拟合的机器学习势能在MD模拟中并不稳定，特别是在NPT集合下，密度波动对分子间相互作用的准确描述非常敏感。迭代训练对于获得稳健的模型至关重要，非物理性的密度波动可用作扩展训练集的依据。

分子内和分子间相互作用有着不同的尺度和维度，这使得机器学习建模变得复杂。我们模型训练中的主要困难来自分子内和分子间相互作用之间的大的不平衡，这很可能是所有分子凝聚相系统中的普遍现象。分子内组分更容易从总能量和力量中拟合，因为它主导了损失函数。然而，明显较弱的分子间组分决定了液体的热力学性质，因此一个好的模型必须非常准确地描述这一部分的相互作用。我们开发了一系列技术，如刚性分子体积扫描和分子内/分子间误差分离。我们运用这些技术来评估势能，并改进其在相关分子间尺度上的性能。

多组分分子液体给机器学习建模带来了额外的挑战，因为它们具有更多样化的局部分子环境。我们证明，即使一个势能旨在模拟某一目标分子组成，仍然需要对所有组成进行训练。这种数据扩展方式确保了所有局部分子环境在训练集中都得到了均匀的表示。

我们进一步发现，在使用SOAP描述符时，需要仔细选择超参数以捕获分子内和分子间的相互作用。我们优化了径向基函数和稀疏集，以实现在这两个尺度上都表现良好的所需折中。

我们预计我们的学习协议将推广到与电池相关的更复杂系统，如电解液（溶剂+盐）和溶剂电极界面（SEI）。在这两种情况下，长程电静力学很可能需要正确捕获离子传输和界面化学。更一般地说，我们在这里学到的经验将有助于指导这些系统中未来的机器学习建模。


## 4. Methods

### 4.1. GAP Models
### 4.2. Iterative Training
### 4.3. Electronic Structure Calculations
### 4.4. Simulations
### 4.5. Experimental Details

## 5. Acknowledgments

## 6. References

[1] Felix Musil, Andrea Grisafi, Albert P Bartók, Christoph Ortner, Gábor Csányi, and Michele Ceriotti. Physics-inspired structural representations for molecules and materials. Chemical Reviews, 121(16):9759-9815, 2021.

[2] Volker L Deringer, Albert P Bartók, Noam Bernstein, David M Wilkins, Michele Ceriotti, and Gábor Csányi. Gaussian process regression for materials and molecules. Chemical Reviews, 121(16):10073-10141, 2021.

[3] Marcel F Langer, Alex Goeßmann, and Matthias Rupp. Representations of molecules and materials for interpolation of quantum-mechanical simulations via machine learning. npj Computational Materials, 8(1):1-14, 2022.

[4] Stefan Chmiela, Huziel E Sauceda, KlausRobert Müller, and Alexandre Tkatchenko. Towards exact molecular dynamics simulations with machine-learned force fields. Nature communications, 9(1):1-10, 2018.

[5] Anders S Christensen and O Anatole von Lilienfeld. On the role of gradients for machine learning of molecular energies and forces. Machine Learning: Science and Technology, 1(4):045018, 2020.

[6] Zhuoran Qiao, Matthew Welborn, Animashree Anandkumar, Frederick R Manby, and Thomas F Miller III. Orbnet: Deep learning for quantum chemistry using symmetry-adapted atomicorbital features. The Journal of chemical physics, 153(12):124111, 2020 [7] Dávid Péter Kovács, Cas van der Oord, Jiri Kucera, Alice EA Allen, Daniel J Cole, Christoph Ortner, and Gábor Csányi. Linear atomic cluster expansion force fields for organic molecules: beyond rmse. Journal of chemical theory and computation, 17(12):7696-7711, 2021.

[8] David Rosenberger, Justin S Smith, and Angel E Garcia. Modeling of peptides with classical and novel machine learning force fields: A comparison. The Journal of Physical Chemistry B, 2021.

[9] Volker L Deringer and Gábor Csányi. Machine learning based interatomic potential for amorphous carbon. Physical Review B, 95(9):094203, 2017.

[10] Albert P Bartók, James Kermode, Noam Bernstein, and Gábor Csányi. Machine learning a general-purpose interatomic potential for silicon. Physical Review X, 8(4):041048, 2018.

[11] Volker L Deringer, Miguel A Caro, and Gábor Csányi. A general-purpose machine-learning force field for bulk and nanostructured phosphorus. $\mathrm{Na}$ ture communications, 11(1):1-11, 2020.

[12] Volker L Deringer, Chris J Pickard, and Gábor Csányi. Data-driven learning of total and local energies in elemental boron. Physical review letters, 120(15):156001, 2018.

[13] Noam Bernstein, Gábor Csányi, and Volker L Deringer. De novo exploration and self-guided learning of potential-energy surfaces. npj Computational Materials, 5(1):1-9, 2019.

[14] Daniele Dragoni, Thomas D Daff, Gábor Csányi, and Nicola Marzari. Achieving dft accuracy with a machine-learning interatomic potential: Thermomechanics and defects in bcc ferromagnetic iron. Physical Review Materials, 2(1):013808, 2018.

[15] Francesco Maresca, Daniele Dragoni, Gábor Csányi, Nicola Marzari, and William A Curtin. Screw dislocation structure and mobility in body centered cubic fe predicted by a gaussian approximation potential. npj Computational Materials, 4(1):1-7, 2018.

[16] Zhigang Zhang, Gábor Csányi, and Dario Alfè. Partitioning of sulfur between solid and liquid iron under earth's core conditions: Constraints from atomistic simulations with machine learning potentials. Geochimica et Cosmochimica Acta, 291:5-18, 2020.

[17] Ganesh Sivaraman, Anand Narayanan Krishnamoorthy, Matthias Baur, Christian Holm, Marius Stan, Gábor Csányi, Chris Benmore, and Álvaro Vázquez-Mayagoitia. Machine-learned interatomic potentials by active learning: amorphous and liquid hafnium dioxide. npj Computational Materials, 6(1):1-8, 2020.
[18] Yuan-Bin Liu, Jia-Yue Yang, Gong-Ming Xin, Lin-Hua Liu, Gábor Csányi, and Bing-Yang Cao. Machine learning interatomic potential developed for molecular simulations on thermal properties of $\beta$-ga2o3. The Journal of Chemical Physics, 153(14):144501, 2020.

[19] Patrick Rowe, Volker L Deringer, Piero Gasparotto, Gábor Csányi, and Angelos Michaelides. An accurate and transferable machine learning potential for carbon. The Journal of Chemical Physics, 153(3):034702, 2020.

[20] Miguel A Caro, Volker L Deringer, Jari Koskinen, Tomi Laurila, and Gábor Csányi. Growth mechanism and origin of high sp3 content in tetrahedral amorphous carbon. Physical review letters, 120(16):166101, 2018.

[21] Miguel A Caro, Gábor Csányi, Tomi Laurila, and Volker L Deringer. Machine learning driven simulated deposition of carbon films: From low-density to diamondlike amorphous carbon. Physical Review $B, 102(17): 174201,2020$.

[22] Jakob Timmermann, Florian Kraushofer, Nikolaus Resch, Peigang Li, Yu Wang, Zhiqiang Mao, Michele Riva, Yonghyuk Lee, Carsten Staacke, Michael Schmid, et al. Iro_2 surface complexions identified through machine learning and surface investigations. Physical review letters, 125(20):206101, 2020.

[23] Letif Mones, Christoph Ortner, and Gábor Csányi. Preconditioners for the geometry optimisation and saddle point search of molecular systems. Scientific reports, 8(1):1-11, 2018.

[24] Bingqing Cheng, Guglielmo Mazzola, Chris J Pickard, and Michele Ceriotti. Evidence for supercritical behaviour of high-pressure liquid hydrogen. Nature, 585(7824):217-220, 2020.

[25] Hongxiang Zong, Heather Wiebe, and Graeme J Ackland. Understanding high pressure molecular hydrogen with a hierarchical machine-learned potential. Nature communications, 11(1):1-9, 2020.

[26] Max Veit, Sandeep Kumar Jain, Satyanarayana Bonakala, Indranil Rudra, Detlef Hohl, and Gábor Csányi. Equation of state of fluid methane from first principles with machine learning potentials. Journal of chemical theory and computation, 15(4):2574-2586, 2019.

[27] Simon Wengert, Gábor Csányi, Karsten Reuter, and Johannes T Margraf. Data-efficient machine learning for molecular crystal structure prediction. Chemical Science, 2021.

[28] Hadrián Montes-Campos, Jesús Carrete, Sebastian Bichelmaier, Luis M Varela, and Georg KH Madsen. A differentiable neural-network force field for ionic liquids. Journal of chemical information and modeling, 62(1):88-101, 2021. [29] Tobias Morawietz, Andreas Singraber, Christoph Dellago, and Jörg Behler. How van der waals interactions determine the unique properties of water. Proceedings of the National Academy of Sciences, 113(30):8368-8373, 2016.

[30] Christoph Schran, Fabian L Thiemann, Patrick Rowe, Erich A Müller, Ondrej Marsalek, and Angelos Michaelides. Machine learning potentials for complex aqueous systems made simple. Proceedings of the National Academy of Sciences, 118(38):e2110077118, 2021.

[31] Linfeng Zhang, Han Wang, Roberto Car, and E Weinan. Phase diagram of a deep potential water model. Physical review letters, 126(23):236001, 2021.

[32] Samuel P Niblett, Mirza Galib, and David T Limmer. Learning intermolecular forces at liquidvapor interfaces. The Journal of Chemical Physics, 155(16):164101, 2021.

[33] Christoph Schran, Jörg Behler, and Dominik Marx. Automated fitting of neural network potentials at coupled cluster accuracy: Protonated water clusters as testing ground. Journal of chemical theory and computation, 16(1):88-99, 2019.

[34] Nan Yao, Xiang Chen, Zhong-Heng Fu, and Qiang Zhang. Applying classical, ab initio, and machine-learning molecular dynamics simulations to the liquid electrolyte for rechargeable batteries. Chemical Reviews, 2022.

[35] Leif D Jacobson, James M Stevenson, Farhad Ramezanghorbani, Delaram Ghoreishi, Karl Leswing, Edward D Harder, and Robert Abel. Transferable neural network potential energy surfaces for closed-shell organic molecules: Extension to ions. Journal of Chemical Theory and Computation, 18(4):2354-2366, 2022.

[36] Steven Dajnowicz, Garvit Agarwal, James M Stevenson, Leif D Jacobson, Farhad Ramezanghorbani, Karl Leswing, Richard A Friesner, Mathew D Halls, and Robert Abel. High-dimensional neural network potential for liquid electrolyte simulations. The Journal of Physical Chemistry B, 126(33):6271-6280, 2022.

[37] Jeffrey B Schriber, Daniel R Nascimento, Alexios Koutsoukas, Steven A Spronk, Daniel L Cheney, and C David Sherrill. Cliff: A componentbased, machine-learned, intermolecular force field. The Journal of Chemical Physics, 154(18):184110, 2021.

[38] Manuel Konrad and Wolfgang Wenzel. Coni-net: Machine learning of separable intermolecular force fields. Journal of Chemical Theory and Computation, 2021.
[39] Gerardo Andrés Cisneros, Kjartan Thor Wikfeldt, Lars Ojamäe, Jibao Lu, Yao Xu, Hedieh Torabifard, Albert P. Bartók, Gábor Csányi, Valeria Molinero, and Francesco Paesani. Modeling molecular interactions in water: From pairwise to manybody potential energy functions. Chemical Reviews, 116(13):7501-7528, 2016.

[40] Jörg Behler. First principles neural network potentials for reactive simulations of large molecular and condensed systems. Angewandte Chemie International Edition, 56(42):12828-12840, 2017.

[41] Tom A Young, Tristan Johnston-Wood, Volker L Deringer, and Fernanda Duarte. A transferable active-learning strategy for reactive molecular force fields. Chemical science, 12(32):1094410955, 2021.

[42] Anirban Mondal, Dina Kussainova, Shuwen Yue, and Athanassios Z Panagiotopoulos. Modeling chemical reactions in alkali carbonate-hydroxide electrolytes with deep learning potentials. Journal of Chemical Theory and Computation, 2022.

[43] Veerapandian Ponnuchamy, Stefano Mossa, and Ioannis Skarmoutsos. Solvent and salt effect on lithium ion solvation and contact ion pair formation in organic carbonates: a quantum chemical perspective. The Journal of Physical Chemistry C, 122(45):25930-25939, 2018.

[44] Ioannis Skarmoutsos, Veerapandian Ponnuchamy, Valentina Vetere, and Stefano Mossa. Li+ solvation in pure, binary, and ternary mixtures of organic carbonate electrolytes. The Journal of Physical Chemistry C, 119(9):4502-4515, 2015.

[45] K Oldiges, D Diddens, M Ebrahiminia, JB Hooper, I Cekic-Laskovic, A Heuer, D Bedrov, $\mathrm{M}$ Winter, and $\mathrm{G}$ Brunklaus. Understanding transport mechanisms in ionic liquid/carbonate solvent electrolyte blends. Physical Chemistry Chemical Physics, 20(24):16579-16591, 2018.

[46] Oleg Borodin and Grant D Smith. Quantum chemistry and molecular dynamics simulation study of dimethyl carbonate: ethylene carbonate electrolytes doped with lipf6. The Journal of Physical Chemistry B, 113(6):1763-1776, 2009.

[47] Oleg Borodin, Marco Olguin, P Ganesh, Paul RC Kent, Joshua L Allen, and Wesley A Henderson. Competitive lithium solvation of linear and cyclic carbonates from quantum chemistry. Physical Chemistry Chemical Physics, 18(1):164-175, 2016.

[48] Verena Perner, Diddo Diddens, Fabian Otteny, Verena Küpers, Peter Bieker, Birgit Esser, Martin Winter, and Martin Kolek. Insights into the solubility of poly (vinylphenothiazine) in carbonatebased battery electrolytes. ACS Applied Materials \& Interfaces, 13(10):12442-12453, 2021. [49] Mitchell T Ong, Osvalds Verners, Erik W Draeger, Adri CT Van Duin, Vincenzo Lordi, and John E Pask. Lithium ion solvation and diffusion in bulk organic electrolytes from first-principles and classical reactive molecular dynamics. The Journal of Physical Chemistry B, 119(4):1535$1545,2015$.

[50] Xiaoliu Zhang and Daniel G Kuroda. An ab initio molecular dynamics study of the solvation structure and ultrafast dynamics of lithium salts in organic carbonates: A comparison between linear and cyclic carbonates. The Journal of chemical physics, 150(18):184501, 2019.

[51] Tsz Wai Ko, Jonas A Finkler, Stefan Goedecker, and Jörg Behler. A fourth-generation highdimensional neural network potential with accurate electrostatics including non-local charge transfer. Nature communications, 12(1):1-11, 2021.

[52] Linfeng Zhang, Han Wang, Maria Carolina Muniz, Athanassios Z Panagiotopoulos, Roberto Car, and Weinan E. A deep potential model with longrange electrostatic interactions. The Journal of Chemical Physics, 156(12):124107, 2022.

[53] Yunqi Shao, Linnéa Andersson, Lisanne Knijff, and Chao Zhang. Finite-field coupling via learning the charge response kernel. Electronic Structure, 4(1):014012, 2022.

[54] Andrea Grisafi and Michele Ceriotti. Incorporating long-range physics in atomic-scale machine learning. The Journal of chemical physics, 151(20):204105, 2019.

[55] Xiaowei Xie, Kristin A Persson, and David W Small. Incorporating electronic information into machine learning potential energy surfaces via approaching the ground-state electronic energy as a function of atom-based electronic populations. Journal of chemical theory and computation, 16(7):4256-4270, 2020.

[56] Ang Gao and Richard C Remsing. Self-consistent determination of long-range electrostatics in neural network potentials. Nature communications, 13(1):1-11, 2022.

[57] Derek P Metcalf, Andy Jiang, Steven A Spronk, Daniel L Cheney, and C David Sherrill. Electronpassing neural networks for atomic charge prediction in systems with arbitrary molecular charge. Journal of Chemical Information and Modeling, 61(1):115-122, 2020

[58] Shuwen Yue, Maria Carolina Muniz, Marcos F Calegari Andrade, Linfeng Zhang, Roberto Car, and Athanassios Z Panagiotopoulos. When do short-range atomistic machine-learning models fall short? The Journal of Chemical Physics, 154(3):034111, 2021.
[59] Stephen J Cox. Dielectric response with shortranged electrostatics. Proceedings of the National Academy of Sciences, 117(33):19746-19752, 2020.

[60] Albert P Bartók, Mike C Payne, Risi Kondor, and Gábor Csányi. Gaussian approximation potentials: The accuracy of quantum mechanics, without the electrons. Physical review letters, 104(13):136403, 2010.

[61] Albert P Bartók, Risi Kondor, and Gábor Csányi. On representing chemical environments. Physical Review B, 87(18):184115, 2013.

[62] William L Jorgensen and Julian Tirado-Rives. Potential energy functions for atomic-level simulations of water and organic and biomolecular systems. Proceedings of the National Academy of Sciences, 102(19):6665-6670, 2005.

[63] Miguel A Caro. Optimizing many-body atomic descriptors for enhanced computational performance of machine learning based interatomic potentials. Physical Review B, 100(2):024112, 2019.

[64] Tuan Anh Pham. Ab initio simulations of liquid electrolytes for energy conversion and storage. International Journal of Quantum Chemistry, 119(1):e25795, 2019.

[65] Mirza Galib, Timothy T. Duignan, Yannick Misteli, Marcel D. Baer, Gregory K. Schenter, Jürg Hutter, and Christopher J. Mundy. Mass density fluctuations in quantum and classical descriptions of liquid water. The Journal of Chemical Physics, 146(24):244501, 2017.

[66] Andrew A Wang, Samuel Greenbank, Guanchen Li, David A Howey, and Charles W Monroe. Current-driven solvent segregation in lithiumion electrolytes. Cell Reports Physical Science, 3(9):101047, 2022.

[67] Paul H Johnson. The properties of ethylene carbonate and its use in electrochemical applications a literature review. California Digital Library, 1985.

[68] Steve Plimpton. Fast parallel algorithms for shortrange molecular dynamics. Journal of computational physics, 117(1):1-19, 1995.

[69] Quip. https://github.com/libAtoms/QUIP.

[70] Stefan Grimme, Stephan Ehrlich, and Lars Goerigk. Effect of the damping function in dispersion corrected density functional theory. Journal of Computational Chemistry, 32(7):1456-1465, 2011.

[71] Stefan Grimme, Andreas Hansen, Jan Gerit Brandenburg, and Christoph Bannwarth. Dispersioncorrected mean-field electronic structure methods. Chemical Reviews, 116(9):5105-5154, 2016. [72] Frank Neese. Software update: The orca program system-version 5.0. WIREs Computational Molecular Science, 12(5):e1606, 2022.

[73] Qianli Ma and Hans-Joachim Werner. Accurate intermolecular interaction energies using explicitly correlated local coupled cluster methods [pnolccsd(t)-f12]. Journal of Chemical Theory and Computation, 15(2):1044-1052, 2019.

[74] Hans-Joachim Werner, Peter J. Knowles, Frederick R. Manby, Joshua A. Black, Klaus Doll, Andreas Heßelmann, Daniel Kats, Andreas Köhn, Tatiana Korona, David A. Kreplin, Qianli Ma, Thomas F. Miller, Alexander Mitrushchenkov, Kirk A. Peterson, Iakov Polyak, Guntram Rauhut, and Marat Sibaev. The molpro quantum chemistry package. The Journal of Chemical Physics, 152(14):144107, 2020.

[75] Stewart J. Clark, Matthew D. Segall, Chris J. Pickard, Phil J. Hasnip, Matt I. J. Probert, Keith Refson, and Mike C. Payne. First principles methods using castep. Zeitschrift für Kristallographie - Crystalline Materials, 220(5-6):567-570, 2005.

[76] Stefan Grimme. Semiempirical gga-type density functional constructed with a long-range dispersion correction. Journal of Computational Chemistry, 27(15):1787-1799, 2006.

[77] Thomas D. Kühne, Marcella Iannuzzi, Mauro Del Ben, Vladimir V. Rybkin, Patrick Seewald, Frederick Stein, Teodoro Laino, Rustam Z. Khaliullin, Ole Schütt, Florian Schiffmann, Dorothea Golze, Jan Wilhelm, Sergey Chulkov, Mohammad Hossein Bani-Hashemian, Valéry Weber, Urban Borštnik, Mathieu Taillefumier, Alice Shoshana Jakobovits, Alfio Lazzaro, Hans Pabst, Tiziano Müller, Robert Schade, Manuel Guidon, Samuel Andermatt, Nico Holmberg, Gregory K. Schenter, Anna Hehn, Augustin Bussy, Fabian Belleflamme, Gloria Tabacchi, Andreas Glöß, Michael Lass, Iain Bethune, Christopher J. Mundy, Christian Plessl, Matt Watkins, Joost VandeVondele, Matthias Krack, and Jürg Hutter. Cp2k: An electronic structure and molecular dynamics software package - quickstep: Efficient and accurate electronic structure calculations. The Journal of Chemical Physics, 152(19):194103, 2020.

[78] Leela S Dodda, Jonah Z Vilseck, Julian TiradoRives, and William L Jorgensen. 1.14* cm1a-lbcc: localized bond-charge corrected cm1a charges for condensed-phase simulations. The Journal of Physical Chemistry B, 121(15):3864-3870, 2017.

[79] Leela S Dodda, Israel Cabeza de Vaca, Julian Tirado-Rives, and William L Jorgensen. Ligpargen web server: an automatic opls-aa parameter generator for organic ligands. Nucleic acids research, 45(W1):W331-W336, 2017.
[80] Giovanni Bussi, Davide Donadio, and Michele Parrinello. Canonical sampling through velocity rescaling. The Journal of Chemical Physics, 126(1):014101, 2007.

